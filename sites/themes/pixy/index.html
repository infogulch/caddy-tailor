{{- $config :=index .Args 0 -}}
{{- $config = $config | merge (dict "template" "page") -}}
{{- include  (printf "/themes/%s/head.html" $config.theme) $config -}}
{{- $files := list  -}}

{{- $listFile := listFiles $config.dir -}}
{{- range $filePath := $listFile -}}
	{{- if ne $filePath "index.md"}}
		{{- $realFilePath := (printf "%s/%s" $config.dir $filePath) -}}
		{{- if hasSuffix ".md" $realFilePath -}}
			{{- $files = append $files $filePath -}}
		{{- end -}}
	{{- end -}}
{{- end -}}

{{- $files = $files|sortAlpha }}

<nav>
	<ul>
		{{- range $file := $files -}}
			{{- $realFile := (printf "%s/%s" $config.dir $file) -}}
			{{- $contentFileContent := (include $realFile | splitFrontMatter) -}}
			{{- $fileConfig := $contentFileContent.Meta -}}
			<li>
				<a href="#{{$fileConfig.title| urlquery}}">{{$fileConfig.title}}</a>
			</li>
		{{- end -}}
	</ul>
</nav>

<div class="container mx-auto">
	{{- range $file := $files -}}
		{{- $realFilePath := (printf "%s/%s" $config.dir $file) -}}
		{{- $contentFileContent := (include $realFilePath | splitFrontMatter) -}}
		{{- $pageConfig := $contentFileContent.Meta -}}
		{{- $content := $contentFileContent.Body -}}
		{{- $config = mergeOverwrite $config $pageConfig -}}
		{{- $config = $config | merge (dict "dir" $config.dir) -}}
		{{- $config = $config | merge (dict "id" (trimSuffix ".md" $file)) -}}
		{{- $themePath := printf "themes/%s/" $config.theme -}}
		{{- $pageTemplate := printf "%s/%s.html" $themePath $config.template -}}
		{{- include $pageTemplate $config $content -}}
	{{- end -}}
</div>
{{- include  (printf "/themes/%s/foot.html" $config.theme) $config -}}
